@model Online_chat.Models.User
@{
    ViewBag.Title = "Hồ sơ của bạn";
    // QUAN TRỌNG: Đổi sang layout của giao diện chat chính
    Layout = "~/Views/Shared/_ChatLayout.cshtml";
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />

<style>
    /* Container chính cho nội dung hồ sơ, lấp đầy không gian và cho phép cuộn */
    .profile-content-area {
        height: 100%;
        overflow-y: auto;
        background-color: #fafffe; /* Nền trắng xanh rất nhạt */
    }

        /* Tùy chỉnh thanh cuộn cho hợp theme */
        .profile-content-area::-webkit-scrollbar {
            width: 8px;
        }

        .profile-content-area::-webkit-scrollbar-track {
            background: #f1f8e9;
        }

        .profile-content-area::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #81c784, #66bb6a);
            border-radius: 10px;
        }

    .profile-header {
        position: relative;
        height: 280px; /* Tăng chiều cao một chút */
        background-color: #e8f5e9; /* Màu nền dự phòng */
        background-size: cover;
        background-position: center;
        border-bottom: 3px solid #e0e0e0;
    }

    .profile-avatar {
        position: absolute;
        bottom: -60px; /* Đẩy avatar xuống */
        left: 50%;
        transform: translateX(-50%);
        width: 140px; /* Tăng kích thước avatar */
        height: 140px;
        border-radius: 50%;
        border: 5px solid #fff; /* Border trắng nổi bật */
        box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        background-color: #c8e6c9;
        background-size: cover;
        background-position: center;
    }

    .profile-body {
        padding: 90px 40px 40px; /* Tăng padding top để không bị avatar che */
        max-width: 700px; /* Giới hạn chiều rộng form cho dễ nhìn */
        margin: 0 auto;
    }

        .profile-body h2 {
            font-weight: 700;
            color: #2e7d32; /* Màu xanh đậm chủ đạo */
        }

    .form-group label {
        font-weight: 600;
        color: #388e3c; /* Màu xanh lá cho label */
        margin-bottom: 8px;
    }

    .form-control {
        background-color: #f1f8e9; /* Nền xanh lá rất nhạt */
        border: 2px solid #c8e6c9;
        border-radius: 12px;
        padding: 10px 15px;
        transition: all 0.3s ease;
    }

        .form-control:focus {
            background-color: #fff;
            border-color: #43a047; /* Border xanh lá khi focus */
            box-shadow: 0 0 0 3px rgba(67, 160, 71, 0.2);
        }

    /* Style lại nút bấm cho đồng bộ */
    .btn-save-profile {
        background: linear-gradient(135deg, #43a047 0%, #388e3c 100%);
        color: white;
        font-weight: 600;
        border: none;
        border-radius: 12px;
        padding: 12px 30px;
        box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
        transition: all 0.3s ease;
    }

        .btn-save-profile:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 125, 50, 0.4);
            color: white;
        }

    /* Style cho input file đẹp hơn */
    .custom-file-upload {
        display: inline-block;
        padding: 8px 15px;
        cursor: pointer;
        background-color: #e8f5e9;
        color: #2e7d32;
        border: 2px dashed #a5d6a7;
        border-radius: 8px;
        font-weight: 500;
    }

        .custom-file-upload i {
            margin-right: 8px;
        }

    input[type="file"] {
        display: none; /* Ẩn input mặc định */
    }
</style>

<div class="profile-content-area">
    @using (Html.BeginForm("Index", "Profile", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()

        <div class="profile-header" style="background-image: url('@(Model.CoverPhotoUrl ?? "/Content/default-cover.jpg")')">
            <div class="profile-avatar" style="background-image: url('@(Model.AvatarUrl ?? "/Content/default-avatar.png")')"></div>
        </div>

        <div class="profile-body">
            <h2 class="text-center">@Model.DisplayName</h2>
            <p class="text-center text-muted">@@@Model.Username</p>
            <p class="text-center" style="font-size: 1rem; color: #555;">ID của bạn: <strong style="color: #2e7d32;">@Model.UserCode</strong></p>
            <hr class="my-4" />

            @if (TempData["SuccessMessage"] != null)
            {
                <div class="alert alert-success text-center">@TempData["SuccessMessage"]</div>
            }

            <div class="form-group">
                @Html.LabelFor(m => m.DisplayName, "Tên hiển thị")
                @Html.TextBoxFor(m => m.DisplayName, new { @class = "form-control" })
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.PhoneNumber, "Số điện thoại")
                @Html.TextBoxFor(m => m.PhoneNumber, new { @class = "form-control" })
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.Gender, "Giới tính")
                @Html.DropDownListFor(m => m.Gender, new SelectList(
                    new[] {
                        new { Value = "", Text = "Chưa cập nhật" },
                        new { Value = "Nam", Text = "Nam" },
                        new { Value = "Nữ", Text = "Nữ" },
                        new { Value = "Khác", Text = "Khác" }
                    },
                    "Value", "Text", Model.Gender
                ), new { @class = "form-control" })
            </div>

            <div class="form-group">
                @Html.LabelFor(m => m.DateOfBirth, "Ngày sinh")
                @Html.TextBoxFor(m => m.DateOfBirth, "{0:yyyy-MM-dd}", new { @class = "form-control", type = "date" })
            </div>

            <div class="form-group">
                @Html.LabelFor(m => m.Bio, "Giới thiệu (Sở thích,...)")
                @Html.TextAreaFor(m => m.Bio, new { @class = "form-control", rows = 4, placeholder = "Viết một vài điều thú vị về bạn..." })
            </div>

            <hr class="my-4" />

            <div class="row">
                <div class="col-md-6 text-center">
                    <div class="form-group">
                        <label>Thay đổi ảnh đại diện</label><br />
                        <label for="avatarFile" class="custom-file-upload">
                            <i class="fas fa-camera"></i> Chọn ảnh
                        </label>
                        <input type="file" name="avatarFile" id="avatarFile" accept="image/*" />
                    </div>
                </div>
                <div class="col-md-6 text-center">
                    <div class="form-group">
                        <label>Thay đổi ảnh bìa</label><br />
                        <label for="coverFile" class="custom-file-upload">
                            <i class="fas fa-image"></i> Chọn ảnh
                        </label>
                        <input type="file" name="coverFile" id="coverFile" accept="image/*" />
                    </div>
                </div>
            </div>

            <div class="form-group text-center mt-4">
                <button type="submit" class="btn btn-save-profile">Lưu thay đổi</button>
            </div>
        </div>
    }
</div>
